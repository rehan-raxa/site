<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Choose Your Plan - PublicBotsHub</title>
  <link rel="stylesheet" href="/static/style.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
</head>
<body>
  <header>
    <nav class="navbar">
      <ul class="nav-links">
        <li><a href="/">Home</a></li>
        <li><a href="/contact">Contact Us</a></li>
        <li><a href="/terms">Terms</a></li>
        <li><a href="/privacy">Privacy</a></li>
        <li><a href="/refund">Refund</a></li>
        <li><a href="/shipping">Shipping</a></li>
      </ul>
    </nav>
  </header>

  <section class="hero">
    <h1>Select a Plan</h1>
    <p>Choose your bot and subscription preferences below.</p>
  </section>

  <div class="plans-container">
    <div class="dropdown-container">
      <label for="bot" class="dropdown-label">Choose a Bot:</label>
      <select id="bot" class="select-dropdown">
        <option value="">-- Select Bot --</option>
        <option value="noads">No Ads Bot</option>
        <option value="autorename">Auto Rename Bot</option>
        <option value="filerename">File Rename Bot</option>
        <option value="savebot">Save Restricted Content Bot</option>
        <option value="savelogs">Save Restricted Content Logs</option>
      </select>
    </div>

    <div id="ads-options" class="dropdown-container" style="display:none;">
      <label for="botCount" class="dropdown-label">Number of Bots:</label>
      <select id="botCount" class="select-dropdown">
        <option value="1">1 Bot</option>
        <option value="3">3 Bots</option>
        <option value="5">5 Bots</option>
        <option value="7">7 Bots</option>
        <option value="9">9 Bots</option>
        <option value="12">12 Bots</option>
        <option value="15">15 Bots</option>
        <option value="all">All Bots</option>
      </select>
    </div>

    <div id="month-options" class="dropdown-container" style="display:none;">
      <label for="months" class="dropdown-label">Duration (Months):</label>
      <select id="months" class="select-dropdown"></select>
    </div>

    <div id="termsWrapper" class="terms-box">
      <input type="checkbox" id="acceptTerms" />
      <label for="acceptTerms">
        I accept the <a id="termsLink" href="/terms" target="_blank">Terms & Conditions</a>
      </label>
    </div>

    <button id="continueBtn" onclick="submitPlan()" disabled style="margin-top: 1.5rem;">Continue</button>
  
  </div>

  <footer>
    <p>&copy; 2025 Mega Mirror. All rights reserved.</p>
  </footer>

  <script>
    const botPlanPrice = {
      noads: {
        1: 10,
        3: 28,
        5: 45,
        7: 61,
        9: 76,
        12: 96,
        15: 117,
        all: 180
      },
      autorename: { 1: 100 },
      filerename: { 1: 100 },
      savebot: { 1: 100 },
      savelogs: { 1: 150 },
    };

    const durationDiscounts = {
      1: 0.00,
      3: 0.12,
      6: 0.18,
      9: 0.24,
      12: 0.30
    };

    let monthChoices;
    let botChoices;
    let botCountChoices;

    function updatePlanOptions() {
      const bot = document.getElementById('bot').value;
      const adsOptions = document.getElementById('ads-options');
      const monthOptions = document.getElementById('month-options');

      if (bot === 'noads') {
        adsOptions.style.display = 'block';
        monthOptions.style.display = 'block';
        updateMonthOptions(); // run once
      } else if (['savebot', 'autorename', 'filerename', 'savelogs'].includes(bot)) {
        adsOptions.style.display = 'none';
        monthOptions.style.display = 'block';
        updateMonthOptions(); // run once
      } else {
        adsOptions.style.display = 'none';
        monthOptions.style.display = 'none';
        if (monthChoices) monthChoices.clearChoices();
      }
    }

    function updateMonthOptions() {
      const bot = document.getElementById('bot').value;
      const botCount = document.getElementById('botCount')?.value || "1";
      const monthSelect = document.getElementById('months');

      // Clear previous native options
      monthSelect.innerHTML = '';

      while (monthSelect.firstChild) {
        monthSelect.removeChild(monthSelect.firstChild);
      }
      const durations = [1, 3, 6, 9, 12];
      const newOptions = [];

      durations.forEach(month => {
        let basePrice = 0;
        let discount = durationDiscounts[month] || 0;

        if (bot === 'noads' && botPlanPrice.noads[botCount]) {
          basePrice = botPlanPrice.noads[botCount];
        } else if (bot !== 'noads' && botPlanPrice[bot]?.[1]) {
          basePrice = botPlanPrice[bot][1];
        } else {
          return;
        }

        const totalPrice = Math.round(month * basePrice * (1 - discount));
        const discountText = (month > 1 && discount > 0) ? ` – ${Math.round(discount * 100)}% off` : '';
        const optionText = `${month} Month(s) – ₹${totalPrice}${discountText}`;
        newOptions.push({ value: month, label: optionText, selected: month === 1});
      });

      if (monthChoices) {
        monthChoices.clearStore(); // full reset
        monthChoices.setChoices(newOptions, 'value', 'label', true);
      }
    }
  
    function submitPlan() {
      const bot = document.getElementById('bot').value;
      const months = document.getElementById('months').value;
      const botCount = document.getElementById('botCount')?.value || "";

      if (!bot || !months) {
        alert("Please select all required options.");
        return;
      }

      let planInfo = `Bot: ${bot}, Duration: ${months} month(s)`;
      if (bot === 'noads') {
        planInfo += `, Bots: ${botCount}`;
      }

      alert("Selected Plan:\n" + planInfo);
    }

    document.addEventListener("DOMContentLoaded", function () {
      botChoices = new Choices("#bot", { 
        searchEnabled: false, 
        itemSelectText: '',
      });
      botCountChoices = new Choices("#botCount", {
        searchEnabled: false,
        itemSelectText: '',
      });
      monthChoices = new Choices("#months", {
        searchEnabled: false,
        itemSelectText: '',
      });

      document.getElementById('bot').addEventListener('change', updatePlanOptions);
      document.getElementById('botCount').addEventListener('change', updateMonthOptions);
    });
  </script>

  <script>
    const botSelect = document.getElementById('bot');
    const termsLink = document.getElementById('termsLink');
    const acceptTerms = document.getElementById('acceptTerms');
    const continueBtn = document.getElementById('continueBtn');

    const termsPages = {
      noads: '/terms-noads',
      autorename: '/terms-autorename',
      filerename: '/terms-filerename',
      savelogs: '/terms-savelogs'
    };

    botSelect.addEventListener('change', () => {
      const selected = botSelect.value;
      if (termsPages[selected]) {
        termsLink.href = termsPages[selected];
      } else {
        termsLink.href = '/terms';
      }
      acceptTerms.checked = false;
      continueBtn.disabled = true;
    });

    acceptTerms.addEventListener('change', () => {
      continueBtn.disabled = !acceptTerms.checked;
    });
</script>

</body>
</html>
